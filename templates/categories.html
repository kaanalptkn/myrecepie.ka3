{% extends "base.html" %}
{% block content %}

<h2 class="center-align">All Recipes</h2>

<div class="container col s12 m10 offset-m1 grey lighten-3 content-container">
    <div class="row">
        <form action="{{ url_for('search') }}" method="POST" class="col s12">
          <div class="row">
                <div class="row valign-wrapper center-align col m6">
                    <div class="input-field col s12 m6">
                        <i class="fas fa-search prefix light-green-text text-darken-3"></i>
                        <input type="text" name="query" id="query" minlength="2" class="validate">
                        <label for="query">Search Recipe</label>
                    </div>
                    <div class="col s5 m4">
                        <button class="btn waves-effect waves-light submit-btn mt-20 " type="submit" id="recipe-search-btn">search</button>
                    </div>
                </div>
                <div class=" row valign-wrapper col m6">
                    <div class="input-field col s12" id="cuisine-select">
                        <select id="cuisine-filter" name="cuisine_select">
                            <option value="" disabled selected>Cuisine</option>
                            {% for cuisine in cuisines %}
                                <option type="text" name="query" id="query" value="{{ cuisine.cuisine_name }}">{{ cuisine.cuisine_name }}</option>
                            {% endfor %}
                        </select>
                        <label for="query">Filter by Cuisine</label>
                    </div>
                    <div class="col s5 m2">
                        <button class="btn waves-effect waves-light submit-btn mt-20" type="submit" id="cusine-filter-btn">Filter</button>
                    </div>
                </div>
                
                <div class="col s7 m4">
                    <a href="{{ url_for('get_categories') }}" class="light-green btn text-shadow">Reset</a>
                </div>
          </div>
        </form>
          
    </div>
</div>

{% if recipes|length > 0 %}
<div class="container container col s12 m10 offset-m1 white-text text-darken-2 content-container mt-20">
   <div class="row">
        {% for recipe in recipes %}
            <div class="img">
                <img src="{{ recipe.image_url }}" alt="{{ recipe.recipe_name }}">
            </div>
            <div class="card-content">
                <h5>{{ recipe.recipe_name }}</h5>
                <p>{{ recipe.cuisine_name }}</p>
                <p>{{ recipe.created_by }}</p>
                <p>{{ recipe.category_name}}</p>
            </div>
            <div class="card-action">
                <a href="{{ url_for('recipe', recipe_id=recipe._id) }}" class="waves-effect waves-light btn-small m-4">Full Recipe</a>

                {% if user == recipe.created_by %}

                        <a href="{{ url_for('edit_recipes', recipe_id=recipe._id) }}" class="waves-effect waves-light green lighten-2 btn-small m-4">edit</a>
                        <a href="#warning" data-target="warning-{{ recipe._id }}" class="waves-effect waves-light red lighten-2 btn-small m-4">delete</a>
            </div>
                    <div id="warning-{{ recipe._id }}" class="modal">
                        <div class="modal-content">
                            <h4>Delete Recipe</h4>
                            <p>Are you sure you want to delete this recipe?</p>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect waves-light btn-small">Back</a>
                            <a href="/delete_recipe/{{ recipe._id }}" class="waves-effect waves-light btn-small red lighten-2">Yes, Delete</a>
                        </div>
                    </div>
            
                {% endif %}

        {% endfor %}      
   </div>
</div> 
{% else %}
    <h3 class="center-align white-text">No Result Found <i class="far fa-sad-cry"></i></h3>
{% endif %}

{% endblock %}